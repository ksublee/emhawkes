<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Kyungsub Lee" />

<meta name="date" content="2023-01-31" />

<title>Example : emhawkes package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Example : emhawkes package</h1>
<h4 class="author">Kyungsub Lee</h4>
<h4 class="date">2023-01-31</h4>



<div id="basic-hawkes-model" class="section level2">
<h2>Basic Hawkes model</h2>
<div id="univariate-hawkes-process" class="section level3">
<h3>Univariate Hawkes process</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emhawkes)</span></code></pre></div>
<p>This subsection outlines the steps for constructing, running
simulations, and estimating a univariate Hawkes model. To begin, create
an <code>hspec</code> object which defines the Hawkes model. S4 class
<code>hspec</code> contains slots for the model parameters:
<code>mu</code>, <code>alpha</code>, <code>beta</code>,
<code>dimens</code>, <code>rmark</code>, and <code>impact</code>.</p>
<p>In a univariate model, the basic parameters of the model,
<code>mu</code>, <code>alpha</code>, <code>beta</code>, can be given as
numeric. If numeric values are given, they will be converted to
matrices. Below is an example of a univariate Hawkes model without a
mark.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1107</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="fl">0.3</span>; alpha1 <span class="ot">&lt;-</span> <span class="fl">1.2</span>; beta1 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>hspec1 <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">&quot;hspec&quot;</span>, <span class="at">mu =</span> mu1, <span class="at">alpha =</span> alpha1, <span class="at">beta =</span> beta1)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(hspec1)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; An object of class &quot;hsepc&quot; of 1-dimensional Hawkes process</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot mu: </span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1]</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]  0.3</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot alpha: </span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1]</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]  1.2</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot beta: </span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1]</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]  1.5</span></span></code></pre></div>
<p>The function <code>hsim</code> implements simulation where the input
arguments are <code>hspec</code>, <code>size</code> and the initial
values of intensity component process, <code>lambda_component0</code>,
and the initial values of Hawkes processes, <code>N0</code>. More
precisely, the intensity process the basic univariate Hawkes model is
represented by <span class="math display">\[ \lambda(t) = \mu +
\int_{-\infty}^t \alpha e^{-\beta (t-s)} d N(s) = \mu + \lambda_c(0)
e^{-\beta t} + \int_0^t \alpha e^{-\beta (t-s)} d N(s) \]</span> where
the <code>lambda_component0</code> denotes <span class="math display">\[
\lambda_c(0) = \int_{-\infty}^0 \alpha e^{\beta s} d N(s).\]</span> If
<code>lambda_component0</code> is not provided, the internally
determined initial values for intensity process are used. If
<code>size</code> is sufficiently large, exact value of
<code>lambda_component0</code> may not be important. The default initial
value of counting process, <code>N0</code>, is zero.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">hsim</span>(hspec1, <span class="at">size =</span> <span class="dv">1000</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The initial values for intensity processes are not provided. Internally determined initial values are used for simulation.</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res1)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simulation result of marked Hawkes model.</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Realized path :</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        arrival N1 mark lambda1</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,]  0.00000  0    0 0.90000</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,]  0.97794  1    1 0.43838</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,]  1.09001  2    1 1.43128</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,]  1.28999  3    1 2.02711</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,]  1.53225  4    1 2.33527</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,]  1.65001  5    1 3.01139</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,]  2.51807  6    1 1.36377</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,]  2.81710  7    1 1.74553</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,]  2.87547  8    1 2.72378</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,]  3.16415  9    1 2.65016</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,]  3.51378 10    1 2.40131</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [12,]  4.22355 11    1 1.43843</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [13,] 16.96752 12    1 0.30000</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [14,] 17.71654 13    1 0.69015</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [15,] 19.10293 14    1 0.49874</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [16,] 24.06354 15    1 0.30082</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [17,] 24.09256 16    1 1.44967</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [18,] 28.40173 17    1 0.30366</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [19,] 28.53743 18    1 1.28198</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [20,] 28.56702 19    1 2.38725</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... with 980 more rows </span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span></code></pre></div>
<p>The results of <code>hsim</code> is an S3 class <code>hreal</code>
which consists of <code>hspec</code>, <code>inter_arrival</code>,
<code>arrival</code>, <code>type</code>, <code>mark</code>,
<code>N</code>, <code>Nc</code>, <code>lambda</code>,
<code>lambda_component</code>, <code>rambda</code>,
<code>rambda_component</code>.</p>
<ul>
<li><p><code>hspec</code> is the model specification</p></li>
<li><p><code>inter_arrival</code> is the inter-arrival time of every
event</p></li>
<li><p><code>arrival</code> is the cumulative sum of
<code>inter_arrival</code></p></li>
<li><p><code>type</code> is the type of events, i.e., <span class="math inline">\(i\)</span> for <span class="math inline">\(N_i\)</span>, and used for multivariate
model</p></li>
<li><p><code>mark</code> is a numeric vector which represents additional
information for the event</p></li>
<li><p><code>lambda</code> represents <span class="math inline">\(\lambda\)</span> which is the left continuous and
right limit version</p></li>
<li><p>The right continuous version of intensity is
<code>rambda</code></p></li>
<li><p><code>lambda_component</code> represents <span class="math inline">\(\lambda_{ij}\)</span> and
<code>rambda_component</code> is the right continuous version.</p></li>
</ul>
<p><code>inter_arrival</code>, <code>type</code>, <code>mark</code>,
<code>N</code>, and <code>Nc</code> start at zero. Using
<code>summary()</code> function, one can print the first 20 elements of
<code>arrival</code>, <code>N</code> and <code>lambda</code>.
<code>print()</code> function also can be used.</p>
<p>By the definition, we have
<code>lambda == mu + lambda_compoent</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first and third columns are the same</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(res1<span class="sc">$</span>lambda[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], res1<span class="sc">$</span>lambda_component[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], mu1 <span class="sc">+</span> res1<span class="sc">$</span>lambda_component[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          [,1]     [,2]     [,3]</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.900000 0.600000 0.900000</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.438383 0.138383 0.438383</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,] 1.431282 1.131282 1.431282</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,] 2.027111 1.727111 2.027111</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [5,] 2.335269 2.035269 2.335269</span></span></code></pre></div>
<p>Except the first row, <code>rambda == lambda + alpha</code> .</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># second and third columns are the same</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(res1<span class="sc">$</span>lambda[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], res1<span class="sc">$</span>rambda[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], res1<span class="sc">$</span>lambda[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] <span class="sc">+</span> alpha1)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          [,1]     [,2]     [,3]</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.900000 0.900000 2.100000</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.438383 1.638383 1.638383</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,] 1.431282 2.631282 2.631282</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,] 2.027111 3.227111 3.227111</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [5,] 2.335269 3.535269 3.535269</span></span></code></pre></div>
<p>Also check the exponential decaying:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># By definition, the following two are equal:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>res1<span class="sc">$</span>lambda[<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.438383 1.431282 2.027111 2.335269 3.011391</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>mu1 <span class="sc">+</span> (res1<span class="sc">$</span>rambda[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] <span class="sc">-</span> mu1) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>beta1 <span class="sc">*</span> res1<span class="sc">$</span>inter_arrival[<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.438383 1.431282 2.027111 2.335269 3.011391</span></span></code></pre></div>
<p>The log-likelihood function is computed by <code>logLik</code>
method. In this case, the inter-arrival times and <code>hspec</code> are
inputs of the function.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(hspec1, <span class="at">inter_arrival =</span> res1<span class="sc">$</span>inter_arrival)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The initial values for intensity processes are not provided. Internally determined initial values are used.</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           [,1]</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] -214.2385</span></span></code></pre></div>
<p>The likelihood estimation is performed using <code>mhfit</code>
function. The specification of the initial values of the parameters,
<code>hspec0</code> is needed. Note that only <code>inter_arrival</code>
is needed in this univariate model. (Indeed, for more precise
simulation, <code>lambda0</code>, the initial value of lambda component,
should be specified. If not, internally determined initial values are
used.) By default, it uses the BFGS method for numerical
optimization.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># initial value for numerical optimization</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="fl">0.5</span>; alpha0 <span class="ot">&lt;-</span> <span class="fl">1.0</span>; beta0 <span class="ot">&lt;-</span> <span class="fl">1.8</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>hspec0 <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">&quot;hspec&quot;</span>, <span class="at">mu =</span> mu0, <span class="at">alpha =</span> alpha0, <span class="at">beta =</span> beta0)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># the intial values are provided through hspec</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>mle <span class="ot">&lt;-</span> <span class="fu">hfit</span>(hspec0, <span class="at">inter_arrival =</span> res1<span class="sc">$</span>inter_arrival)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The initial values for intensity processes are not provided. Internally determined initial values are used for estimation.</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mle)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BFGS maximization, 24 iterations</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Return code 0: successful convergence </span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -213.4658 </span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  free parameters</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimates:</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Estimate Std. error t value Pr(&gt; t)    </span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu1     0.33641    0.03486    9.65  &lt;2e-16 ***</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha1  1.16654    0.09980   11.69  &lt;2e-16 ***</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta1   1.52270    0.13019   11.70  &lt;2e-16 ***</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
</div>
<div id="bivariate-hawkes-model" class="section level3">
<h3>Bivariate Hawkes model</h3>
<p>The intensity process of basic bivariate Hawkes model is defined
by</p>
<p><span class="math display">\[
\lambda_1(t) = \mu_1 + \int_{-\infty}^t \alpha_{11} e^{-\beta_{11}(t-s)}
d N_1(s) + \int_{-\infty}^t \alpha_{12} e^{-\beta_{12}(t-s)} d N_2(s),
\]</span></p>
<p><span class="math display">\[
\lambda_2(t) = \mu_2 + \int_{-\infty}^t \alpha_{21} e^{-\beta_{21}(t-s)}
d N_1(s) + \int_{-\infty}^t \alpha_{22} e^{-\beta_{22}(t-s)} d N_2(s).
\]</span></p>
<p>In a bivariate model, the parameters, the slots of
<code>hspec</code>, are matrices. <code>mu</code> is 2-by-1, and
<code>alpha</code> and <code>beta</code> are 2-by-2 matrices:</p>
<p><span class="math display">\[
\mu = \begin{bmatrix} \mu_1 \\ \mu_2 \end{bmatrix}, \quad
\alpha = \begin{bmatrix} \alpha_{11} &amp; \alpha_{12} \\ \alpha_{21}
&amp; \alpha_{22} \end{bmatrix}, \quad
\beta =
\begin{bmatrix} \beta_{11} &amp; \beta_{12} \\ \beta_{21} &amp;
\beta_{22} \end{bmatrix}
\]</span></p>
<p><code>rmark</code> is a random number generating function for mark
and is not used for non-mark model. <code>lambda_component0</code>,
2-by-2 matrix, represents the initial values of
<code>lambda_component</code>, a set of
<code>lambda11, lambda12, lambda21, lambda22</code>. The intensity
processes are represented by</p>
<p><span class="math display">\[ \lambda_1(t) = \mu_1 + \lambda_{11}(t)
+ \lambda_{12}(t), \]</span></p>
<p><span class="math display">\[ \lambda_2(t) = \mu_2 + \lambda_{21}(t)
+ \lambda_{22}(t). \]</span></p>
<p><span class="math inline">\(\lambda_{ij}\)</span> called lambda
components and <code>lambda0</code> is <span class="math inline">\(\lambda_{ij}(0)\)</span>.</p>
<p><code>lambda_component0</code> can be omitted and then internally
determined initial values are used.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.2</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>alpha2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">0.5</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>beta2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">2.25</span>, <span class="fl">2.25</span>, <span class="fl">2.25</span>, <span class="fl">2.25</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>hspec2 <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">&quot;hspec&quot;</span>, <span class="at">mu=</span>mu2, <span class="at">alpha=</span>alpha2, <span class="at">beta=</span>beta2)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(hspec2)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; An object of class &quot;hsepc&quot; of 2-dimensional Hawkes process</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot mu: </span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1]</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]  0.2</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]  0.2</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot alpha: </span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]  0.5  0.9</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]  0.9  0.5</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot beta: </span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 2.25 2.25</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 2.25 2.25</span></span></code></pre></div>
<p>To simulate, use function <code>hsim</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">hsim</span>(hspec2,  <span class="at">size=</span><span class="dv">1000</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The initial values for intensity processes are not provided. Internally determined initial values are used for simulation.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res2)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simulation result of marked Hawkes model.</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Realized path :</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        arrival N1 N2 mark lambda1 lambda2</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,]  0.00000  0  0    0 0.52941 0.52941</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,]  0.45174  1  0    1 0.31921 0.31921</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,]  1.08505  2  0    1 0.34893 0.44514</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,]  1.80625  3  0    1 0.32808 0.42601</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,]  5.85572  4  0    1 0.20007 0.20012</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,]  7.06679  4  1    1 0.23278 0.25901</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,]  7.29302  5  1    1 0.76068 0.53601</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,]  7.40387  5  2    1 1.02655 1.16317</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,]  7.41410  6  2    1 1.88724 1.62986</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,]  7.44747  6  3    1 2.22904 2.36135</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,]  7.51014  6  4    1 2.74383 2.51135</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [12,]  7.67411  6  5    1 2.58131 2.14396</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [13,] 10.80975  6  6    1 0.20283 0.20211</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [14,] 20.12343  7  6    1 0.20000 0.20000</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [15,] 27.36900  8  6    1 0.20000 0.20000</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [16,] 27.71327  9  6    1 0.43044 0.61479</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [17,] 29.31115 10  6    1 0.22005 0.23610</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [18,] 30.38241 10  7    1 0.24669 0.28405</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [19,] 31.85751 11  7    1 0.23426 0.22114</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [20,] 32.02988 12  7    1 0.56251 0.82501</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... with 980 more rows </span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span></code></pre></div>
<p><code>type</code> is crucial in multi-variate models, which
represents the type of event.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Under bi-variate model, there are two types, 1 or 2.</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>res2<span class="sc">$</span>type[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] 0 1 1 1 1 2 1 2 1 2</span></span></code></pre></div>
<p>The column names of <code>N</code> are <code>N1</code>,
<code>N2</code>, <code>N3</code> and so on, for multivariate models.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>res2<span class="sc">$</span>N[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, ]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      N1 N2</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]  0  0</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]  1  0</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,]  2  0</span></span></code></pre></div>
<p>Similarly, the column names of <code>lambda</code> are
<code>lambda1</code>, <code>lambda2</code>, <code>lambda3</code> and so
on.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>res2<span class="sc">$</span>lambda[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, ]</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        lambda1   lambda2</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.5294118 0.5294118</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.3192112 0.3192112</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,] 0.3489332 0.4451416</span></span></code></pre></div>
<p>The column names of <code>lambda_component</code> are
<code>lambda_component11</code>, <code>lambda_component12</code>,
<code>lambda_component13</code> and so on.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>res2<span class="sc">$</span>lambda_component[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, ]</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        lambda11   lambda12   lambda21   lambda22</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.11764706 0.21176471 0.21176471 0.11764706</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.04257541 0.07663575 0.07663575 0.04257541</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,] 0.13050071 0.01843250 0.23490128 0.01024028</span></span></code></pre></div>
<p>By definition, the following two are the same:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mu2[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">rowSums</span>(res2<span class="sc">$</span>lambda_component[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fu">c</span>(<span class="st">&quot;lambda11&quot;</span>, <span class="st">&quot;lambda12&quot;</span>)])</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.5294118 0.3192112 0.3489332 0.3280770 0.2000693</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>res2<span class="sc">$</span>lambda[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="st">&quot;lambda1&quot;</span>]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.5294118 0.3192112 0.3489332 0.3280770 0.2000693</span></span></code></pre></div>
<p>From the result, we get vectors of realized
<code>inter_arrival</code> and <code>type</code>. Bivariate model
requires <code>inter_arrival</code> and <code>type</code> for
estimation.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>inter_arrival2 <span class="ot">&lt;-</span> res2<span class="sc">$</span>inter_arrival</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>type2 <span class="ot">&lt;-</span> res2<span class="sc">$</span>type</span></code></pre></div>
<p>Log-likelihood is computed by a function <code>logLik</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(hspec2, <span class="at">inter_arrival =</span> inter_arrival2, <span class="at">type =</span> type2)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The initial values for intensity processes are not provided. Internally determined initial values are used.</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -1155.221</span></span></code></pre></div>
<p>A maximum log-likelihood estimation is performed using
<code>hfit</code>. In the following, the values of parameter slots in
<code>hspec0</code>, such as <code>mu, alpha, beta</code>, serve as
starting points of the numerical optimization. For the purpose of
illustration, we use <code>hspec0 &lt;- hspec2</code>. Since the true
parameter values are not known in practical applications, the initial
guess is used. The realized <code>inter_arrival</code> and
<code>type</code> are used for estimation.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>hspec0 <span class="ot">&lt;-</span> hspec2</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>mle <span class="ot">&lt;-</span> <span class="fu">hfit</span>(hspec0, <span class="at">inter_arrival =</span> inter_arrival2, <span class="at">type =</span> type2)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The initial values for intensity processes are not provided. Internally determined initial values are used for estimation.</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mle)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BFGS maximization, 35 iterations</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Return code 0: successful convergence </span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -1153.699 </span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  free parameters</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimates:</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Estimate Std. error t value  Pr(&gt; t)    </span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu1       0.19244    0.01457  13.209  &lt; 2e-16 ***</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha1.1  0.61305    0.07819   7.841 4.48e-15 ***</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha1.2  0.88418    0.09465   9.342  &lt; 2e-16 ***</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta1.1   2.29655    0.20506  11.199  &lt; 2e-16 ***</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mle)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       mu1  alpha1.1  alpha1.2   beta1.1 </span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.1924436 0.6130518 0.8841788 2.2965457</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>miscTools<span class="sc">::</span><span class="fu">stdEr</span>(mle)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        mu1   alpha1.1   alpha1.2    beta1.1 </span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.01456893 0.07818747 0.09464793 0.20506267</span></span></code></pre></div>
</div>
<div id="parameter-setting" class="section level3">
<h3>Parameter setting</h3>
<p>This subsection covers about the relation between parameter setting
and estimation procedure in multi-variate Hawkes model. The number of
parameters to be estimated in the model depends on how we set the
parameter slots such as <code>mu</code>, <code>alpha</code> and
<code>beta</code> in <code>hspec0</code>, the specification for initial
values. Since the parameter slot such as <code>alpha</code> is a matrix,
and the element in the matrix can be the same or different. The number
of parameters in the estimation varies depending on whether or not some
of the elements in the initial setting are the same or different.</p>
<p>For example, if <code>alpha[1,1]</code> and <code>alpha[1,2]</code>
in <code>hspec0</code> are different in initial starting, the numerical
procedure tries to estimate both parameters of <code>alpha[1,1]</code>
and <code>alpha[1,2]</code> differently. If <code>alpha[1,1]</code> and
<code>alpha[1,2]</code> are the same in the initial setting, then the
estimation procedure considered two parameters are identical in the
model and hence only one value is estimated.</p>
<p>Recall that the example in the previous section is of a symmetric
Hawkes model where the matrix <code>alpha</code> is symmetric. In
addition, the elements of <code>beta</code> are all the same.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(hspec2)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; An object of class &quot;hsepc&quot; of 2-dimensional Hawkes process</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot mu: </span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1]</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]  0.2</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]  0.2</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot alpha: </span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]  0.5  0.9</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]  0.9  0.5</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot beta: </span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 2.25 2.25</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 2.25 2.25</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">hsim</span>(hspec2, <span class="at">size =</span> <span class="dv">1000</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The initial values for intensity processes are not provided. Internally determined initial values are used for simulation.</span></span></code></pre></div>
<p>In the first example of estimation, the initial value of
<code>alpha0</code> is a matrix where the all elements have the same
value of 0.75. In this configuration, <code>hfit</code> assumes that
<code>alpha11 == alpha12 == alpha21 == alpha22</code> in the model (even
if the actual parameters have different values). Similarly, the other
parameter matrices <code>mu0</code> and <code>beta0</code> are also
treated in the same way.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.15</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>alpha0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.75</span>, <span class="fl">0.75</span>, <span class="fl">0.75</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">2.6</span>, <span class="fl">2.6</span>, <span class="fl">2.6</span>, <span class="fl">2.6</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>hspec0 <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">&quot;hspec&quot;</span>, <span class="at">mu=</span>mu0, <span class="at">alpha=</span>alpha0, <span class="at">beta=</span>beta0)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">hfit</span>(hspec0, <span class="at">inter_arrival =</span> res2<span class="sc">$</span>inter_arrival, <span class="at">type =</span> res2<span class="sc">$</span>type))</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The initial values for intensity processes are not provided. Internally determined initial values are used for estimation.</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BFGS maximization, 27 iterations</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Return code 0: successful convergence </span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -1452.179 </span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  free parameters</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimates:</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Estimate Std. error t value Pr(&gt; t)    </span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu1       0.20553    0.01405   14.63  &lt;2e-16 ***</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha1.1  0.61267    0.05758   10.64  &lt;2e-16 ***</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta1.1   2.17234    0.20925   10.38  &lt;2e-16 ***</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p>Note that in the above result, <code>alpha1.1</code> is somewhere
between original <code>alpha1.1 = 0.5</code> and
<code>alpha1.2 = 0.9</code>.</p>
<p>In the following second example, <code>alpha0</code>s elements are
not same, but symmetric as in the original values in the simulation. We
have <code>alpha11 == alpha22</code> and <code>alpha11 == alpha22</code>
in <code>alpha0</code> and hence <code>alpha11</code> and
<code>alpha12</code> will be estimated differently.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.15</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>alpha0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.751</span>, <span class="fl">0.751</span>, <span class="fl">0.75</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">2.6</span>, <span class="fl">2.6</span>, <span class="fl">2.6</span>, <span class="fl">2.6</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>hspec0 <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">&quot;hspec&quot;</span>, <span class="at">mu=</span>mu0, <span class="at">alpha=</span>alpha0, <span class="at">beta=</span>beta0)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">hfit</span>(hspec0, <span class="at">inter_arrival =</span> res2<span class="sc">$</span>inter_arrival, <span class="at">type =</span> res2<span class="sc">$</span>type))</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The initial values for intensity processes are not provided. Internally determined initial values are used for estimation.</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BFGS maximization, 32 iterations</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Return code 0: successful convergence </span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -1446.605 </span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  free parameters</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimates:</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Estimate Std. error t value  Pr(&gt; t)    </span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu1       0.20625    0.01409  14.641  &lt; 2e-16 ***</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha1.1  0.44832    0.06714   6.677 2.44e-11 ***</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha1.2  0.78307    0.08702   8.999  &lt; 2e-16 ***</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta1.1   2.18866    0.21322  10.265  &lt; 2e-16 ***</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p>In the third example, the estimation is performed under the
assumption that <code>mu1</code> and <code>mu2</code> may also be
different (even though they are the same in the original model).</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.14</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>alpha0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.751</span>, <span class="fl">0.751</span>, <span class="fl">0.75</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">2.6</span>, <span class="fl">2.6</span>, <span class="fl">2.6</span>, <span class="fl">2.6</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>hspec0 <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">&quot;hspec&quot;</span>, <span class="at">mu=</span>mu0, <span class="at">alpha=</span>alpha0, <span class="at">beta=</span>beta0)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">hfit</span>(hspec0, <span class="at">inter_arrival =</span> res2<span class="sc">$</span>inter_arrival, <span class="at">type =</span> res2<span class="sc">$</span>type))</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The initial values for intensity processes are not provided. Internally determined initial values are used for estimation.</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BFGS maximization, 38 iterations</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Return code 0: successful convergence </span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -1446.346 </span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  free parameters</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimates:</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Estimate Std. error t value  Pr(&gt; t)    </span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu1       0.19770    0.01801  10.978  &lt; 2e-16 ***</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu2       0.21493    0.01878  11.447  &lt; 2e-16 ***</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha1.1  0.44765    0.06535   6.850 7.39e-12 ***</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha1.2  0.78386    0.08384   9.349  &lt; 2e-16 ***</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta1.1   2.18967    0.19821  11.047  &lt; 2e-16 ***</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p>By simply setting <code>reduced = FALSE</code>, all parameters are
estimated (not recommended).</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">hfit</span>(hspec2, <span class="at">inter_arrival =</span> res2<span class="sc">$</span>inter_arrival, <span class="at">type =</span> res2<span class="sc">$</span>type, <span class="at">reduced=</span><span class="cn">FALSE</span>))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The initial values for intensity processes are not provided. Internally determined initial values are used for estimation.</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BFGS maximization, 57 iterations</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Return code 0: successful convergence </span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -1446.275 </span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  free parameters</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimates:</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Estimate Std. error t value  Pr(&gt; t)    </span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu1       0.19807    0.01933  10.247  &lt; 2e-16 ***</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu2       0.21443    0.02305   9.301  &lt; 2e-16 ***</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha1.1  0.47011    0.14692   3.200  0.00138 ** </span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha2.1  0.79003    0.15344   5.149 2.62e-07 ***</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha1.2  0.77643    0.12187   6.371 1.88e-10 ***</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha2.2  0.42980    0.14530   2.958  0.00310 ** </span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta1.1   2.36707    0.89765   2.637  0.00837 ** </span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta2.1   2.24280    0.46762   4.796 1.62e-06 ***</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta1.2   2.13501    0.37341   5.718 1.08e-08 ***</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta2.2   2.04468    0.92742   2.205  0.02748 *  </span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p>The same logic is applied to all the higher dimensional model.</p>
</div>
<div id="residual-process" class="section level3">
<h3>Residual process</h3>
<p>Residual process can be extracted by <code>residual_process()</code>.
<code>inter_arrival</code>, <code>type</code>,
<code>rambda_component</code>, <code>mu</code>,<code>beta</code> should
be provided. The <code>component</code> denotes the type of the process
to be extracted for multivariate model. For example, for a bi-variate
model, we have <span class="math inline">\(N_1\)</span> and $N_2$.
<code>component=1</code> is for the residual of <span class="math inline">\(N_1\)</span> and <code>component=2</code> is for
the residual of <span class="math inline">\(N_2\)</span>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>hrp <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">&quot;hspec&quot;</span>, <span class="at">mu =</span> <span class="fl">0.3</span>, <span class="at">alpha =</span> <span class="fl">1.2</span>, <span class="at">beta =</span> <span class="fl">1.5</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>res_rp <span class="ot">&lt;-</span> <span class="fu">hsim</span>(hrp, <span class="at">size =</span> <span class="dv">1000</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>rp <span class="ot">&lt;-</span> <span class="fu">residual_process</span>(<span class="at">component =</span> <span class="dv">1</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">inter_arrival =</span> res_rp<span class="sc">$</span>inter_arrival, <span class="at">type =</span> res_rp<span class="sc">$</span>type, </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">rambda_component =</span> res_rp<span class="sc">$</span>rambda_component, </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mu =</span> <span class="fl">0.3</span>, <span class="at">beta =</span> <span class="fl">1.5</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(<span class="dv">100</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(rp,<span class="at">p=</span>p)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">qexp</span>(p), q, <span class="at">xlab=</span><span class="st">&quot;Theoretical Quantiles&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(q, <span class="at">distribution=</span>qexp,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>In case that <code>rambda_component</code> is unknown, it can be
inferred by <code>infer_lambda()</code>. For
<code>infer_lambda()</code>, the model <code>hspec</code>,
<code>inter_arrival</code> and <code>type</code> are required. The above
example is then:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># estimation</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>mle_rp <span class="ot">&lt;-</span> <span class="fu">hfit</span>(<span class="fu">new</span>(<span class="st">&quot;hspec&quot;</span>, <span class="at">mu =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">beta =</span> <span class="dv">2</span>),</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>               res_rp<span class="sc">$</span>inter_arrival)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># construct hspec from estimation result</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>he <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">&quot;hspec&quot;</span>, <span class="at">mu =</span> <span class="fu">coef</span>(mle_rp)[<span class="st">&quot;mu1&quot;</span>], </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha =</span> <span class="fu">coef</span>(mle_rp)[<span class="st">&quot;alpha1&quot;</span>], <span class="at">beta =</span> <span class="fu">coef</span>(mle_rp)[<span class="st">&quot;beta1&quot;</span>])</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># infer intensity</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>infered_res <span class="ot">&lt;-</span> <span class="fu">infer_lambda</span>(he, res_rp<span class="sc">$</span>inter_arrival, res_rp<span class="sc">$</span>type)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co"># compute residuals where we use </span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>rp2 <span class="ot">&lt;-</span> <span class="fu">residual_process</span>(<span class="at">component =</span> <span class="dv">1</span>,</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">inter_arrival =</span> res_rp<span class="sc">$</span>inter_arrival, <span class="at">type =</span> res_rp<span class="sc">$</span>type, </span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">rambda_component =</span> infered_res<span class="sc">$</span>rambda_component, </span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mu =</span> <span class="fu">coef</span>(mle_rp)[<span class="st">&quot;mu1&quot;</span>], <span class="at">beta =</span> <span class="fu">coef</span>(mle_rp)[<span class="st">&quot;beta1&quot;</span>])</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(<span class="dv">100</span>)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(rp2, <span class="at">p=</span>p)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">qexp</span>(p), q, <span class="at">xlab=</span><span class="st">&quot;Theoretical Quantiles&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(q, <span class="at">distribution=</span>qexp,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="more-complicated-model" class="section level2">
<h2>More complicated model</h2>
<div id="multi-kernel-model" class="section level3">
<h3>Multi-kernel model</h3>
<p>In a multi-kernel Hawkes model, <code>type_col_map</code> is required
for <code>hspec</code>. <code>type_col_map</code> is a list that
represents the mapping between type and column number. For example,
consider a bi-variate multi-kernel model: <span class="math display">\[
\lambda_t = \mu + \int_{-\infty}^{t} h(t-u) d N(u)
\]</span> where <span class="math display">\[ h = \sum_{k=1}^{K} h_k,
\quad
h_k (t) = \alpha_k \circ \begin{bmatrix}
e^{-\beta_{k11} t} &amp; e^{-\beta_{k12} t} \\
e^{-\beta_{k21} t} &amp; e^{-\beta_{k22} t}
\end{bmatrix}
\]</span></p>
<p>with matrix <span class="math inline">\(\alpha_k\)</span> and <span class="math inline">\(k\)</span> denoting kernel number.</p>
<p>For example, in a bi-variate Hawkes model with two kernels, the
intensity processes are</p>
<p><span class="math display">\[
\begin{bmatrix} \lambda_1(t) \\ \lambda_2(t) \end{bmatrix} =
\begin{bmatrix} \mu_1 \\ \mu_2 \end{bmatrix} + \int_{-\infty}^{t}
\begin{bmatrix}
\alpha_{111} e^{-\beta_{111} t} &amp; \alpha_{112} e^{-\beta_{112} t} \\
\alpha_{121}e^{-\beta_{121} t} &amp; \alpha_{122}e^{-\beta_{122} t}
\end{bmatrix} \begin{bmatrix} d N_1(s) \\ dN_2(s) \end{bmatrix}
+ \int_{-\infty}^{t} \begin{bmatrix}
\alpha_{211} e^{-\beta_{211} t} &amp; \alpha_{212} e^{-\beta_{212} t} \\
\alpha_{221}e^{-\beta_{221} t} &amp; \alpha_{222}e^{-\beta_{222} t}
\end{bmatrix} \begin{bmatrix} d N_1(s) \\ dN_2(s) \end{bmatrix}.
\]</span></p>
<p>The parameter matrix is defined by</p>
<p><span class="math display">\[
\alpha = \begin{bmatrix} \alpha_{111} &amp; \alpha_{112} &amp;
\alpha_{211} &amp; \alpha_{212} \\ \alpha_{121} &amp; \alpha_{122} &amp;
\alpha_{221} &amp; \alpha_{222}
\end{bmatrix}, \quad
\beta = \begin{bmatrix} \beta_{111} &amp; \beta_{112} &amp; \beta_{211}
&amp; \beta_{212} \\ \beta_{121} &amp; \beta_{122} &amp; \beta_{221}
&amp; \beta_{222}
\end{bmatrix} \quad
\]</span></p>
<p>and we should specify which columns of matrix are associated with
which <span class="math inline">\(N_i\)</span>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.02</span>), <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">10</span>, <span class="dv">4</span>), <span class="at">nrow=</span><span class="dv">2</span>) </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>beta_2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">4</span>), <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>beta  <span class="ot">&lt;-</span> <span class="fu">cbind</span>(beta_1, beta_2)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>alpha_1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>alpha_2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.2</span>,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">0.2</span>, <span class="fl">0.3</span>), <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">cbind</span>(alpha_1, alpha_2)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(alpha)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]    3    2  0.3  0.2</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]    2    3  0.2  0.3</span></span></code></pre></div>
<p>Note that <span class="math inline">\(d N_1(s)\)</span> is multiplied
by first and third columns of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(dN_2(s)\)</span> is multiplied by second and
fourth columns of <span class="math inline">\(\alpha\)</span> and hence
<code>type_col_map</code> is</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>type_col_map <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),  <span class="co"># columns for dN1</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>))  <span class="co"># columns for dN2</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>type_col_map</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1 3</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2 4</span></span></code></pre></div>
<p>where type <code>i</code> is associated with columns of
<code>type_col_map[[i]]</code>. Thus,</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Part of alpha associated with N1: </span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Part of alpha associated with N1:</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>alpha[, type_col_map[[<span class="dv">1</span>]]]  <span class="co"># associated with N1</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]    3  0.3</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]    2  0.2</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Part of alpha associated with N2: </span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Part of alpha associated with N2:</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>alpha[, type_col_map[[<span class="dv">2</span>]]]  <span class="co"># associated with N2</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]    2  0.2</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]    3  0.3</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Part of beta associated with N1: </span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Part of beta associated with N1:</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>beta[, type_col_map[[<span class="dv">1</span>]]]  <span class="co"># associated with N1</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]   10    1</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]   10    1</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Part of beta associated with N2: </span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Part of beta associated with N2:</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>beta[, type_col_map[[<span class="dv">2</span>]]]  <span class="co"># associated with N2</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]   10    1</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]   10    1</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">&quot;hspec&quot;</span>, <span class="at">mu =</span> mu, <span class="at">alpha =</span> alpha, <span class="at">beta=</span>beta, <span class="at">type_col_map =</span> type_col_map)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>h</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; An object of class &quot;hsepc&quot; of 2-dimensional Hawkes process</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot mu: </span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1]</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.02</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.02</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot alpha: </span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]    3    2  0.3  0.2</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]    2    3  0.2  0.3</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot beta: </span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]   10   10    1    1</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]   10   10    1    1</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot type_col_map: </span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1 3</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2 4</span></span></code></pre></div>
<p>In addition, <code>lambda_component0</code> should be provided for
simulation and estimation.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>res_mk <span class="ot">&lt;-</span> <span class="fu">hsim</span>(h, <span class="at">size =</span> <span class="dv">2000</span>, </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>               <span class="co"># for an illustration purpose</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">lambda_component0 =</span> <span class="fu">matrix</span>(<span class="fu">seq</span>(<span class="dv">1</span>, <span class="fl">1.7</span>, <span class="fl">0.1</span>), <span class="at">nrow =</span> <span class="dv">2</span>)) </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>res_mk</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simulation result of marked Hawkes model.</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; An object of class &quot;hsepc&quot; of 2-dimensional Hawkes process</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot mu: </span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1]</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.02</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.02</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot alpha: </span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]    3    2  0.3  0.2</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]    2    3  0.2  0.3</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot beta: </span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]   10   10    1    1</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]   10   10    1    1</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot type_col_map: </span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1 3</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2 4</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Realized path :</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       arrival N1 N2 mark lambda1 lambda2 lambda11 lambda12 lambda13 lambda14</span></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.00000  0  0    0   5.220   5.620   1.0000   1.1000    1.200    1.300</span></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 0.07015  1  0    1   3.392   4.534   0.4959   0.5455    1.119    1.212</span></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.17930  1  1    1   3.735   4.112   1.1736   0.1831    1.272    1.087</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.30659  2  1    1   3.213   4.034   0.3286   0.6113    1.120    1.133</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 0.34314  3  1    1   5.215   5.156   2.3096   0.4242    1.369    1.092</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.35253  4  1    1   7.975   6.951   4.8338   0.3861    1.653    1.082</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.35850  5  1    1  10.781   8.794   7.3798   0.3638    1.942    1.076</span></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.36815  5  2    1  13.060  10.272   9.4243   0.3303    2.220    1.065</span></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.43375  5  3    1   9.384   8.622   4.8907   1.2093    2.079    1.185</span></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.48780  5  4    1   8.020   8.346   2.8485   1.8692    1.970    1.312</span></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 0.52019  6  4    1   8.250   9.389   2.0605   2.7988    1.907    1.464</span></span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [12,] 0.61771  6  5    1   6.314   6.500   1.9084   1.0555    2.002    1.328</span></span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [13,] 0.62451  7  5    1   8.164   9.388   1.7830   2.8546    1.988    1.517</span></span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [14,] 0.70313  7  6    1   7.017   7.210   2.1789   1.3004    2.115    1.403</span></span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [15,] 0.80564  7  7    1   5.342   6.006   0.7817   1.1841    1.909    1.447</span></span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [16,] 0.83007  7  8    1   6.596   8.061   0.6123   2.4938    1.863    1.607</span></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [17,] 0.87075  7  9    1   6.943   8.805   0.4076   2.9919    1.789    1.735</span></span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [18,] 0.90271  7 10    1   7.549   9.846   0.2961   3.6262    1.733    1.874</span></span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [19,] 0.91728  7 11    1   8.891  11.911   0.2560   4.8639    1.708    2.044</span></span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [20,] 0.99000  8 11    1   7.135   9.471   0.1237   3.3170    1.588    2.087</span></span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       lambda21 lambda22 lambda23 lambda24</span></span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,]  1.40000   1.5000    1.600    1.700</span></span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,]  0.69421   0.7438    1.492    1.585</span></span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,]  0.90447   0.2497    1.517    1.421</span></span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,]  0.25326   0.9099    1.335    1.515</span></span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,]  1.56347   0.6314    1.480    1.461</span></span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,]  3.24415   0.5748    1.665    1.447</span></span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,]  4.94020   0.5415    1.854    1.439</span></span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,]  6.30130   0.4916    2.034    1.425</span></span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,]  3.27006   1.8120    1.905    1.615</span></span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,]  1.90458   2.8026    1.804    1.815</span></span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,]  1.37771   4.1974    1.747    2.047</span></span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [12,]  1.27382   1.5830    1.766    1.857</span></span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [13,]  1.19007   4.2817    1.754    2.142</span></span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [14,]  1.45323   1.9505    1.806    1.980</span></span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [15,]  0.52138   1.7761    1.630    2.058</span></span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [16,]  0.40835   3.7407    1.591    2.301</span></span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [17,]  0.27187   4.4878    1.528    2.498</span></span>
<span id="cb33-73"><a href="#cb33-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [18,]  0.19749   5.4393    1.479    2.710</span></span>
<span id="cb33-74"><a href="#cb33-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [19,]  0.17073   7.2958    1.458    2.966</span></span>
<span id="cb33-75"><a href="#cb33-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [20,]  0.08251   4.9755    1.356    3.037</span></span>
<span id="cb33-76"><a href="#cb33-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... with 1980 more rows </span></span>
<span id="cb33-77"><a href="#cb33-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">hfit</span>(h, res_mk<span class="sc">$</span>inter_arrival, res_mk<span class="sc">$</span>type,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">lambda_component0 =</span> <span class="fu">matrix</span>(<span class="fu">seq</span>(<span class="dv">1</span>, <span class="fl">1.7</span>, <span class="fl">0.1</span>), <span class="at">nrow =</span> <span class="dv">2</span>)))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BFGS maximization, 44 iterations</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Return code 0: successful convergence </span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: 3045.102 </span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  free parameters</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimates:</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Estimate Std. error t value  Pr(&gt; t)    </span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu1      0.020655   0.005892   3.506 0.000456 ***</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha1.1 3.134528   0.265585  11.802  &lt; 2e-16 ***</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha1.2 2.056690   0.249917   8.230  &lt; 2e-16 ***</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha1.3 0.131581   0.058441   2.252 0.024353 *  </span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha1.4 0.234245   0.067582   3.466 0.000528 ***</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta1.1  9.423118        NaN     NaN      NaN    </span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta1.3  0.834374   0.111776   7.465 8.35e-14 ***</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
</div>
<div id="synchronized-intensity-model" class="section level3">
<h3>Synchronized intensity model</h3>
<p>This model is basically two-kernel model and defined little bit
complicated reparamterization.</p>
<p><span class="math display">\[
\mu = \begin{bmatrix} \theta/(1 - \kappa)/2 + \tilde\theta/(1 +
\kappa)/2 \\
\theta/(1 - \kappa)/2 - \tilde\theta/(1 + \kappa)/2 \end{bmatrix}, \quad
\theta = (\theta^- + \theta^+)/2,\quad \tilde\theta=(\theta^-
-\theta^+)/2
\]</span></p>
<p><span class="math display">\[
\alpha = \begin{bmatrix} \zeta &amp; \tilde\zeta &amp; \zeta &amp;
-\tilde\zeta \\
\zeta &amp; -\tilde\zeta &amp; \zeta &amp; \tilde\zeta
\end{bmatrix}, \quad \zeta = (\eta + \nu) / 2, \quad \tilde \zeta =
(\eta - \nu)/ 2
\]</span></p>
<p><span class="math display">\[
\beta = \begin{bmatrix} \beta_1 &amp; \beta_2 &amp; \beta_1 &amp;
\beta_2 \\
\beta_1 &amp; \beta_2 &amp; \beta_1 &amp; \beta_2 \end{bmatrix}, \quad
\beta_1 = (\eta + \nu) / 2, \quad \beta_2 = (\eta - \nu)/2
\]</span></p>
<p>In order to handle complex re-parametrization, each slot is expressed
as a function rather than a matrix. The first argument
<code>param</code> is a set of parameters.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">param =</span> <span class="fu">c</span>(<span class="at">theta_p =</span> <span class="fl">0.15</span>, <span class="at">theta_n =</span> <span class="fl">0.21</span>, <span class="at">kappa =</span> <span class="fl">0.12</span>)){</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  theta    <span class="ot">&lt;-</span> (param[<span class="st">&quot;theta_n&quot;</span>] <span class="sc">+</span> param[<span class="st">&quot;theta_p&quot;</span>])<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  theta_tl <span class="ot">&lt;-</span> (param[<span class="st">&quot;theta_n&quot;</span>] <span class="sc">-</span> param[<span class="st">&quot;theta_p&quot;</span>])<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="fu">c</span>(theta<span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> param[<span class="st">&quot;kappa&quot;</span>]) <span class="sc">+</span> theta_tl<span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> param[<span class="st">&quot;kappa&quot;</span>]),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>           theta<span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> param[<span class="st">&quot;kappa&quot;</span>]) <span class="sc">-</span> theta_tl<span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> param[<span class="st">&quot;kappa&quot;</span>])), <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">param =</span> <span class="fu">c</span>(<span class="at">eta =</span> <span class="dv">5</span>, <span class="at">nu =</span> <span class="dv">3</span>)){</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  zeta    <span class="ot">&lt;-</span> (param[<span class="st">&quot;eta&quot;</span>] <span class="sc">+</span> param[<span class="st">&quot;nu&quot;</span>])<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  zeta_tl <span class="ot">&lt;-</span> (param[<span class="st">&quot;eta&quot;</span>] <span class="sc">-</span> param[<span class="st">&quot;nu&quot;</span>])<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="fu">c</span>(zeta, zeta_tl, zeta, <span class="sc">-</span>zeta_tl,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>           zeta, <span class="sc">-</span>zeta_tl, zeta, zeta_tl), <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">param =</span> <span class="fu">c</span>(<span class="at">beta =</span> <span class="dv">12</span>, <span class="at">kappa =</span> <span class="fl">0.12</span>)){</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  beta1 <span class="ot">&lt;-</span> param[<span class="st">&quot;beta&quot;</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> param[<span class="st">&quot;kappa&quot;</span>])</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  beta2 <span class="ot">&lt;-</span> param[<span class="st">&quot;beta&quot;</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> param[<span class="st">&quot;kappa&quot;</span>])</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="fu">c</span>(beta1, beta2, beta1, beta2,</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>           beta1, beta2, beta1, beta2), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>type_col_map <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>))</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>h_sy <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">&quot;hspec&quot;</span>, <span class="at">mu =</span> mu, <span class="at">alpha =</span> alpha, <span class="at">beta =</span> beta, <span class="at">type_col_map =</span> type_col_map)</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>h_sy</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; An object of class &quot;hsepc&quot; of 2-dimensional Hawkes process</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot mu: </span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; function(param = c(theta_p = 0.15, theta_n = 0.21, kappa = 0.12)){</span></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   theta    &lt;- (param[&quot;theta_n&quot;] + param[&quot;theta_p&quot;])/2</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   theta_tl &lt;- (param[&quot;theta_n&quot;] - param[&quot;theta_p&quot;])/2</span></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   matrix(c(theta/2/(1 - param[&quot;kappa&quot;]) + theta_tl/2/(1 + param[&quot;kappa&quot;]),</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            theta/2/(1 - param[&quot;kappa&quot;]) - theta_tl/2/(1 + param[&quot;kappa&quot;])), nrow=2)</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000027a9183c268&gt;</span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot alpha: </span></span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; function(param = c(eta = 5, nu = 3)){</span></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   zeta    &lt;- (param[&quot;eta&quot;] + param[&quot;nu&quot;])/2</span></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   zeta_tl &lt;- (param[&quot;eta&quot;] - param[&quot;nu&quot;])/2</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   matrix(c(zeta, zeta_tl, zeta, -zeta_tl,</span></span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            zeta, -zeta_tl, zeta, zeta_tl), nrow=2, byrow=TRUE)</span></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000027a9183c268&gt;</span></span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot beta: </span></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; function(param = c(beta = 12, kappa = 0.12)){</span></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   beta1 &lt;- param[&quot;beta&quot;] * (1 - param[&quot;kappa&quot;])</span></span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   beta2 &lt;- param[&quot;beta&quot;] * (1 + param[&quot;kappa&quot;])</span></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   matrix(c(beta1, beta2, beta1, beta2,</span></span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            beta1, beta2, beta1, beta2), nrow = 2, byrow = TRUE)</span></span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000027a9183c268&gt;</span></span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot type_col_map: </span></span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1 2</span></span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3 4</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run simulation</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>res_sy <span class="ot">&lt;-</span> <span class="fu">hsim</span>(h_sy, <span class="at">size =</span> <span class="dv">2000</span>, <span class="at">lambda_component0 =</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">2</span> <span class="sc">*</span> <span class="dv">4</span>), <span class="at">nrow=</span><span class="dv">2</span>))</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res_sy)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simulation result of marked Hawkes model.</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Realized path :</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         arrival N1 N2 mark  lambda1  lambda2</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,]  0.000000  0  0    0  4.11567  4.08888</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,]  0.070185  0  1    1  1.84748  1.82069</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,]  0.115018  0  2    1  3.07961  4.14764</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,]  0.202363  0  3    1  2.58595  3.51595</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,]  0.202621  1  3    1  5.57203  8.49177</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,]  0.228158  1  4    1  8.11899  8.76375</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,]  0.275585  1  5    1  6.88016  8.26571</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,]  0.534843  2  5    1  0.80398  0.88186</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,]  0.558298  2  6    1  4.50760  3.09794</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,]  0.621263  2  7    1  3.94368  4.18165</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 10.646319  3  7    1  0.11567  0.08888</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [12,] 10.692853  3  8    1  3.09778  2.00092</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [13,] 14.367382  4  8    1  0.11567  0.08888</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [14,] 14.661734  4  9    1  0.31350  0.24844</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [15,] 14.676306  4 10    1  2.89197  4.47800</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [16,] 14.749612  4 11    1  2.93772  4.25978</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [17,] 14.767749  5 11    1  4.99332  7.59096</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [18,] 14.782096  6 11    1  8.61547  9.10360</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [19,] 14.786881  7 11    1 12.94070 11.52132</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [20,] 14.837901  8 11    1 10.38070  8.64495</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... with 1980 more rows </span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span></code></pre></div>
<p>The estimation is based on function arguments <code>param</code>. In
addition, the initial values of the numerical optimization is the
default values specified in <code>param</code>. Note that the same name
arguments are treated as the same parameter. <code>kappa</code> is in
both of <code>mu</code> and <code>beta</code>, but only one
<code>kappa</code> appears in the estimation result.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>fit_sy <span class="ot">&lt;-</span> <span class="fu">hfit</span>(h_sy, <span class="at">inter_arrival=</span>res_sy<span class="sc">$</span>inter_arrival, </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">type=</span>res_sy<span class="sc">$</span>type,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">lambda_component0 =</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">2</span> <span class="sc">*</span> <span class="dv">4</span>), <span class="at">nrow=</span><span class="dv">2</span>))</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_sy)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BFGS maximization, 40 iterations</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Return code 0: successful convergence </span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -185.6958 </span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  free parameters</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimates:</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Estimate Std. error t value  Pr(&gt; t)    </span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; theta_p  0.13479    0.01701   7.926 2.26e-15 ***</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; theta_n  0.21716    0.01753  12.388  &lt; 2e-16 ***</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; kappa    0.18762    0.03384   5.544 2.95e-08 ***</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; eta      4.94486    0.22840  21.650  &lt; 2e-16 ***</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; nu       3.26335    0.17484  18.664  &lt; 2e-16 ***</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta    13.24212        NaN     NaN      NaN    </span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
</div>
</div>
<div id="extended-model" class="section level2">
<h2>Extended model</h2>
<p>The following family of extended multi-variate marked Hawkes models
are implemented:</p>
<p><span class="math display">\[
\lambda(t) = \mu + \int_{(-\infty,t)\times E} h(t, u, z)M(du \times dz)
\]</span></p>
<p>where the kernel <span class="math inline">\(h\)</span> is
represented by</p>
<p><span class="math display">\[
h(t, u, z) = (\alpha + g(t, z))\Gamma(t),
\]</span></p>
<p>and</p>
<ul>
<li><p><span class="math inline">\(\alpha\)</span> is a constant
matrix,</p></li>
<li><p><span class="math inline">\(g(t, z)\)</span> is additional
impacts on intensities, which may depend on mark, or any information
generated by underlying processes,</p></li>
<li><p><span class="math inline">\(\Gamma(t)\)</span> is exponential
decaying matrix such that <span class="math inline">\(\Gamma_{ij}(t) =
e^{-\beta_{ij}(t)}\)</span>,</p></li>
<li><p><span class="math inline">\(M\)</span> denotes the random
measures defined on the product of time and mark spaces.</p></li>
</ul>
<div id="linear-impact-model" class="section level3">
<h3>Linear impact model</h3>
<p>In the linear impact model,</p>
<p><span class="math display">\[
g(t, z) = \eta (z-1).
\]</span></p>
<p><code>impact</code> represents <span class="math inline">\(\Psi(z)\)</span>, the impact of mark on future
intensity. It is a function, and the first argument is
<code>param</code> represents the parameter of the model.
<code>impact()</code> function can have additional arguments related to
the model specification or generated path, such as <code>n</code>,
<code>mark</code>, etc. Do not miss <code>...</code> as the ellipsis is
omitted, an error occurs. <code>rmark()</code> is a function that
generate marks for simulation.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.15</span>), <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.6</span>, <span class="fl">0.6</span>, <span class="fl">0.75</span>), <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">byrow=</span>T)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">2.6</span>, <span class="fl">2.6</span>, <span class="fl">2.6</span>, <span class="fl">2.6</span>), <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>rmark <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">param =</span> <span class="fu">c</span>(<span class="at">p=</span><span class="fl">0.65</span>), ...){</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rgeom</span>(<span class="dv">1</span>, <span class="at">p=</span>param[<span class="dv">1</span>]) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>impact <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">param =</span> <span class="fu">c</span>(<span class="at">eta1=</span><span class="fl">0.2</span>), alpha, n, mark, ...){</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  ma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(mark[n]<span class="sc">-</span><span class="dv">1</span>, <span class="dv">4</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  ma <span class="sc">*</span> <span class="fu">matrix</span>( <span class="fu">rep</span>(param[<span class="st">&quot;eta1&quot;</span>], <span class="dv">4</span>), <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>hi <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">&quot;hspec&quot;</span>, <span class="at">mu=</span>mu, <span class="at">alpha=</span>alpha, <span class="at">beta=</span>beta,</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">rmark =</span> rmark,</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">impact=</span>impact)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>hi</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; An object of class &quot;hsepc&quot; of 2-dimensional Hawkes process</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot mu: </span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1]</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.15</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.15</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot alpha: </span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.75 0.60</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.60 0.75</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot beta: </span></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]  2.6  2.6</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]  2.6  2.6</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot impact: </span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; function(param = c(eta1=0.2), alpha, n, mark, ...){</span></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ma &lt;- matrix(rep(mark[n]-1, 4), nrow = 2)</span></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ma * matrix( rep(param[&quot;eta1&quot;], 4), nrow=2)</span></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000027a9183c268&gt;</span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot rmark: </span></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; function(param = c(p=0.65), ...){</span></span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   rgeom(1, p=param[1]) + 1</span></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000027a9183c268&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>res_impact <span class="ot">&lt;-</span> <span class="fu">hsim</span>(hi, <span class="at">size=</span><span class="dv">1000</span>, <span class="at">lambda_component0 =</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fl">0.1</span>,<span class="dv">4</span>), <span class="at">nrow=</span><span class="dv">2</span>))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res_impact)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simulation result of marked Hawkes model.</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Realized path :</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         arrival N1 N2 mark lambda1 lambda2</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,]  0.000000  0  0    0 0.35000 0.35000</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,]  0.057871  0  1    1 0.32206 0.32206</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,]  1.285922  0  2    4 0.18169 0.18785</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,]  1.341407  0  3    1 1.21623 1.35141</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,]  1.754653  1  3    1 0.71900 0.81639</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 13.225292  1  4    2 0.15000 0.15000</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 14.102382  2  4    1 0.23179 0.24713</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 14.236517  3  4    1 0.73689 0.64187</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 14.612964  3  5    1 0.65237 0.56030</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 16.448581  3  6    2 0.15932 0.15981</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 16.652090  3  7    1 0.62679 0.71545</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [12,] 16.948788  3  8    1 0.64786 0.75821</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [13,] 17.530604  4  8    1 0.39187 0.44923</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [14,] 17.581394  4  9    3 1.01917 0.93799</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [15,] 18.009144  5  9    1 0.76468 0.78731</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [16,] 18.279468  6  9    2 0.82576 0.76269</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [17,] 18.527888  7  9    1 1.00221 0.89052</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [18,] 19.961005  7 10    1 0.18859 0.18229</span></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [19,] 23.389848  7 11    2 0.15009 0.15011</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [20,] 24.332375  7 12    1 0.21900 0.23194</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... with 980 more rows </span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">hfit</span>(hi, </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">inter_arrival =</span> res_impact<span class="sc">$</span>inter_arrival,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">type =</span> res_impact<span class="sc">$</span>type,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">mark =</span> res_impact<span class="sc">$</span>mark,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">lambda_component0 =</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fl">0.1</span>,<span class="dv">4</span>), <span class="at">nrow=</span><span class="dv">2</span>))</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BFGS maximization, 38 iterations</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Return code 0: successful convergence </span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -1347.967 </span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  free parameters</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimates:</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Estimate Std. error t value  Pr(&gt; t)    </span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu1       0.15764    0.01070  14.730  &lt; 2e-16 ***</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha1.1  0.76060    0.08909   8.538  &lt; 2e-16 ***</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha1.2  0.51457    0.07843   6.561 5.36e-11 ***</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta1.1   2.38183    0.20207  11.787  &lt; 2e-16 ***</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; eta1      0.19451    0.06697   2.904  0.00368 ** </span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p>For a special case of linear impact function, the following
implementation is recommended. In a marked Hawkes model, the additional
linear impact can be represented by slot <code>eta</code>. In this
model, the intensity process is</p>
<p><span class="math display">\[
\lambda(t) = \mu + \int_{(-\infty, t)\times E} (\alpha + \eta (z-1))
e^{-\beta(t-u)}  M(dt \times dz).
\]</span></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>rmark <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">param =</span> <span class="fu">c</span>(<span class="at">p=</span><span class="fl">0.65</span>), ...){</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rgeom</span>(<span class="dv">1</span>, <span class="at">p=</span>param[<span class="dv">1</span>]) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span>  <span class="fu">new</span>(<span class="st">&quot;hspec&quot;</span>, <span class="at">mu=</span><span class="fl">0.15</span>, <span class="at">alpha=</span><span class="fl">0.7</span>, <span class="at">beta=</span><span class="fl">1.6</span>, <span class="at">eta=</span><span class="fl">0.3</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">rmark =</span> rmark)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>h</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; An object of class &quot;hsepc&quot; of 1-dimensional Hawkes process</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot mu: </span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1]</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.15</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot alpha: </span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1]</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]  0.7</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot beta: </span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1]</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]  1.6</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot eta: </span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1]</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]  0.3</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot rmark: </span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; function(param = c(p=0.65), ...){</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   rgeom(1, p=param[1]) + 1</span></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000027a9183c268&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">hsim</span>(h, <span class="at">size =</span> <span class="dv">1000</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The initial values for intensity processes are not provided. Internally determined initial values are used for simulation.</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simulation result of marked Hawkes model.</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Realized path :</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       arrival N1 mark lambda1</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,]  0.0000  0    0 0.20833</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,]  4.5365  1    1 0.15004</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,]  4.9423  2    2 0.51573</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,]  5.1798  3    2 1.08405</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 11.7006  4    1 0.15006</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 14.7204  5    1 0.15558</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 14.8475  6    1 0.72582</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 15.2601  7    2 0.80928</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 15.3169  8    1 1.66509</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 15.4846  9    2 1.84381</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 15.5771 10    1 2.47337</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [12,] 15.5999 11    2 3.06498</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [13,] 15.7263 12    1 3.34829</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [14,] 16.2462 13    2 1.84656</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [15,] 16.8126 14    2 1.23949</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [16,] 23.9730 15    1 0.15002</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [17,] 33.8192 16    2 0.15000</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [18,] 34.6933 17    1 0.39695</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [19,] 34.7530 18    1 1.01069</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [20,] 35.0490 19    1 1.12199</span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... with 980 more rows </span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">hfit</span>(h, </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">inter_arrival =</span> res<span class="sc">$</span>inter_arrival,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">type =</span> res<span class="sc">$</span>type,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">mark =</span> res<span class="sc">$</span>mark)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The initial values for intensity processes are not provided. Internally determined initial values are used for estimation.</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BFGS maximization, 39 iterations</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Return code 0: successful convergence </span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -1757.824 </span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  free parameters</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimates:</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Estimate Std. error t value  Pr(&gt; t)    </span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu1    0.147779   0.008233  17.950  &lt; 2e-16 ***</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha1 0.627044   0.065366   9.593  &lt; 2e-16 ***</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta1  1.589530   0.125852  12.630  &lt; 2e-16 ***</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; eta1   0.349112   0.069626   5.014 5.33e-07 ***</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p>If you want to estimate the mark distribution also, then
<code>dmark</code> slot that describes the density function of mark is
required.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>h_md <span class="ot">&lt;-</span> h</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>h_md<span class="sc">@</span>dmark <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">param =</span> <span class="fu">c</span>(<span class="at">p =</span> <span class="fl">0.1</span>), <span class="at">n=</span>n, <span class="at">mark=</span>mark, ...){</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">dgeom</span>(mark[n] <span class="sc">-</span> <span class="dv">1</span>, <span class="at">prob =</span> param[<span class="st">&quot;p&quot;</span>])</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>mle_md <span class="ot">&lt;-</span> <span class="fu">hfit</span>(h_md, </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">inter_arrival =</span> res<span class="sc">$</span>inter_arrival, <span class="at">type =</span> res<span class="sc">$</span>type, <span class="at">mark =</span> res<span class="sc">$</span>mark)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The initial values for intensity processes are not provided. Internally determined initial values are used for estimation.</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mle_md)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BFGS maximization, 41 iterations</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Return code 0: successful convergence </span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -2778.854 </span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  free parameters</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimates:</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Estimate Std. error t value  Pr(&gt; t)    </span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu1    0.147779   0.008242  17.929  &lt; 2e-16 ***</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha1 0.627045   0.065566   9.564  &lt; 2e-16 ***</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta1  1.589534   0.128177  12.401  &lt; 2e-16 ***</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; eta1   0.349112   0.070261   4.969 6.74e-07 ***</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; p      0.639565   0.012128  52.734  &lt; 2e-16 ***</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
</div>
<div id="hawkes-flocking-model" class="section level3">
<h3>Hawkes flocking model</h3>
<p>The function <span class="math inline">\(g\)</span> is not
necessarily depend on mark. In the Hawkes flocking model, the kernel
component is represented by<span class="math display">\[
\alpha = \begin{bmatrix}\alpha_{11} &amp; \alpha_{12} &amp; 0 &amp; 0
\\\alpha_{12}&amp; \alpha_{11} &amp; 0 &amp; 0 \\0 &amp; 0 &amp;
\alpha_{33} &amp; \alpha_{34} \\0 &amp; 0 &amp; \alpha_{34} &amp;
\alpha_{33} \end{bmatrix},
\]</span> <span class="math display">\[
g = \begin{bmatrix} 0 &amp; 0 &amp; \alpha_{1w} 1_{\{C_1(t) &lt;
C_2(t)\}} &amp; \alpha_{1n} 1_{\{C_1(t) &lt; C_2(t)\}} \\
0 &amp; 0 &amp; \alpha_{1n} 1_{\{C_1(t) &gt; C_2(t)\}} &amp;
\alpha_{1w}1_{\{C_1(t) &gt; C_2(t)\}} \\
\alpha_{2w} 1_{\{C_2(t) &lt; C_1(t)\}} &amp; \alpha_{2n}1_{\{C_2(t) &lt;
C_1(t)\}} &amp; 0 &amp; 0 \\
\alpha_{2n} 1_{\{C_2(t) &gt; C_1(t)\}} &amp; \alpha_{2w}1_{\{C_2(t) &gt;
C_1(t)\}} &amp; 0 &amp; 0 \end{bmatrix},
\]</span></p>
<p>where<span class="math display">\[
C_1(t) = N_1(t) - N_2(t), \quad C_2(t) = N_3(t) - N_4(t).
\]</span></p>
<p>In the basic model, <code>alpha</code> is a matrix, but it can be a
function as in the following code. The function <code>alpha</code>
simply return a <span class="math inline">\(4\times4\)</span> matrix but
by doing so, we can fix some of elements as specific vales when
estimating. When estimating, the optimization is only applied for the
specified parameters in the argument <code>param</code>. In the case of
simulation, there is no difference whether the parameter set is
represented by a matrix or a function.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.02</span>, <span class="fl">0.04</span>, <span class="fl">0.04</span>), <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">param =</span> <span class="fu">c</span>(<span class="at">alpha11 =</span> <span class="fl">0.2</span>, <span class="at">alpha12 =</span> <span class="fl">0.3</span>, <span class="at">alpha33 =</span> <span class="fl">0.3</span>, <span class="at">alpha34 =</span> <span class="fl">0.4</span>)){</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="fu">c</span>(param[<span class="st">&quot;alpha11&quot;</span>], param[<span class="st">&quot;alpha12&quot;</span>], <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>           param[<span class="st">&quot;alpha12&quot;</span>], param[<span class="st">&quot;alpha11&quot;</span>], <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>           <span class="dv">0</span>, <span class="dv">0</span>, param[<span class="st">&quot;alpha33&quot;</span>], param[<span class="st">&quot;alpha34&quot;</span>],</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>           <span class="dv">0</span>, <span class="dv">0</span>, param[<span class="st">&quot;alpha34&quot;</span>], param[<span class="st">&quot;alpha33&quot;</span>]), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.7</span>, <span class="dv">8</span>), <span class="fu">rep</span>(<span class="fl">1.1</span>, <span class="dv">8</span>)), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><code>impact()</code> function is little bit complicated, but it is
nothing more than expressing the definition of the model to an R
function. Note that we specify <code>N=N, n=n</code> in the argument.
<code>N</code> is for counting process <span class="math inline">\(N\)</span> and <code>n</code> denotes the time
step. Both are needed to implement the function body and it is required
to specify in the argument. <code></code> also should not be
omitted.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>impact <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">param =</span> <span class="fu">c</span>(<span class="at">alpha1n=</span><span class="fl">0.25</span>, <span class="at">alpha1w=</span><span class="fl">0.1</span>, <span class="at">alpha2n=</span><span class="fl">0.1</span>, <span class="at">alpha2w=</span><span class="fl">0.2</span>),</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">N=</span>N, <span class="at">n=</span>n, ...){</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  Psi <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, param[<span class="st">&#39;alpha1w&#39;</span>], param[<span class="st">&#39;alpha1n&#39;</span>],</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>                  <span class="dv">0</span>, <span class="dv">0</span>, param[<span class="st">&#39;alpha1n&#39;</span>], param[<span class="st">&#39;alpha1w&#39;</span>],</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>                  param[<span class="st">&#39;alpha2w&#39;</span>], param[<span class="st">&#39;alpha2n&#39;</span>], <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>                  param[<span class="st">&#39;alpha2n&#39;</span>], param[<span class="st">&#39;alpha2w&#39;</span>], <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow=</span><span class="dv">4</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  ind <span class="ot">&lt;-</span> N[,<span class="st">&quot;N1&quot;</span>][n] <span class="sc">-</span> N[,<span class="st">&quot;N2&quot;</span>][n] <span class="sc">&gt;</span> N[,<span class="st">&quot;N3&quot;</span>][n] <span class="sc">-</span> N[,<span class="st">&quot;N4&quot;</span>][n]</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  km <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">!</span>ind, <span class="sc">!</span>ind, <span class="sc">!</span>ind, <span class="sc">!</span>ind,</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>                 ind, ind, ind, ind,</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>                 ind, ind, ind, ind,</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>                 <span class="sc">!</span>ind, <span class="sc">!</span>ind, <span class="sc">!</span>ind, <span class="sc">!</span>ind), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  km <span class="sc">*</span> Psi</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>hspec_fl <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">&quot;hspec&quot;</span>,</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">mu =</span> mu, <span class="at">alpha =</span> alpha, <span class="at">beta =</span> beta, <span class="at">impact =</span> impact)</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>hspec_fl</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; An object of class &quot;hsepc&quot; of 4-dimensional Hawkes process</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot mu: </span></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1]</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.02</span></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.02</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,] 0.04</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,] 0.04</span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot alpha: </span></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; function(param = c(alpha11 = 0.2, alpha12 = 0.3, alpha33 = 0.3, alpha34 = 0.4)){</span></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   matrix(c(param[&quot;alpha11&quot;], param[&quot;alpha12&quot;], 0, 0,</span></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            param[&quot;alpha12&quot;], param[&quot;alpha11&quot;], 0, 0,</span></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            0, 0, param[&quot;alpha33&quot;], param[&quot;alpha34&quot;],</span></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            0, 0, param[&quot;alpha34&quot;], param[&quot;alpha33&quot;]), nrow = 4, byrow = TRUE)</span></span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000027a9183c268&gt;</span></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot beta: </span></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]  0.7  0.7  0.7  0.7</span></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]  0.7  0.7  0.7  0.7</span></span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,]  1.1  1.1  1.1  1.1</span></span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,]  1.1  1.1  1.1  1.1</span></span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot impact: </span></span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; function(param = c(alpha1n=0.25, alpha1w=0.1, alpha2n=0.1, alpha2w=0.2),</span></span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                    N=N, n=n, ...){</span></span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Psi &lt;- matrix(c(0, 0, param[&#39;alpha1w&#39;], param[&#39;alpha1n&#39;],</span></span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   0, 0, param[&#39;alpha1n&#39;], param[&#39;alpha1w&#39;],</span></span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   param[&#39;alpha2w&#39;], param[&#39;alpha2n&#39;], 0, 0,</span></span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   param[&#39;alpha2n&#39;], param[&#39;alpha2w&#39;], 0, 0), nrow=4, byrow=TRUE)</span></span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ind &lt;- N[,&quot;N1&quot;][n] - N[,&quot;N2&quot;][n] &gt; N[,&quot;N3&quot;][n] - N[,&quot;N4&quot;][n]</span></span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   km &lt;- matrix(c(!ind, !ind, !ind, !ind,</span></span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  ind, ind, ind, ind,</span></span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  ind, ind, ind, ind,</span></span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  !ind, !ind, !ind, !ind), nrow = 4, byrow = TRUE)</span></span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   km * Psi</span></span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000027a9183c268&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>hr_fl <span class="ot">&lt;-</span> <span class="fu">hsim</span>(hspec_fl, <span class="at">size=</span><span class="dv">1000</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The initial values for intensity processes are not provided. Internally determined initial values are used for simulation.</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hr_fl)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simulation result of marked Hawkes model.</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Realized path :</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       arrival N1 N2 N3 N4 mark  lambda1  lambda2  lambda3  lambda4</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,]  0.0000  0  0  0  0    0 0.070000 0.070000 0.110000 0.110000</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,]  1.2793  0  0  0  1    1 0.040420 0.040420 0.057137 0.057137</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,]  2.2434  0  0  0  2    1 0.030398 0.081322 0.184452 0.149822</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,]  4.7739  0  1  0  2    1 0.021769 0.047441 0.073657 0.065335</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,]  4.9708  0  1  1  2    1 0.282922 0.218163 0.147633 0.060402</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,]  5.4371  0  2  1  2    1 0.281836 0.162968 0.284044 0.291688</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,]  5.7018  1  2  1  2    1 0.486830 0.304972 0.222408 0.377610</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,]  6.2979  2  2  1  2    1 0.459340 0.405408 0.134684 0.267155</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,]  6.6156  2  3  1  2    1 0.531848 0.568730 0.247765 0.200153</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,]  7.2575  2  3  2  2    1 0.537990 0.497718 0.142542 0.217754</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 10.0636  2  4  2  2    1 0.106678 0.087004 0.058377 0.066375</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [12,] 10.0711  3  4  2  2    1 0.404668 0.285616 0.058227 0.264529</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [13,] 11.1695  3  4  2  3    1 0.291006 0.282175 0.045445 0.136941</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [14,] 12.0410  3  4  3  3    1 0.303070 0.162444 0.195448 0.192187</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [15,] 12.0956  3  4  4  3    1 0.388705 0.157102 0.468898 0.559999</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [16,] 12.2291  3  4  4  4    1 0.446904 0.144875 0.669383 0.834393</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [17,] 12.4804  3  4  4  5    1 0.587698 0.124728 0.820735 0.870042</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [18,] 12.5662  3  5  4  5    1 0.790039 0.118624 1.114410 1.068281</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [19,] 12.6038  3  5  5  5    1 1.062283 0.310878 1.070940 1.218586</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [20,] 12.8947  3  6  5  5    1 0.951807 0.257281 1.006428 1.186250</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... with 980 more rows </span></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>fit_fl <span class="ot">&lt;-</span> <span class="fu">hfit</span>(hspec_fl, hr_fl<span class="sc">$</span>inter_arrival, hr_fl<span class="sc">$</span>type)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The initial values for intensity processes are not provided. Internally determined initial values are used for estimation.</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_fl)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BFGS maximization, 89 iterations</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Return code 0: successful convergence </span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -1688.599 </span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12  free parameters</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimates:</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Estimate Std. error t value  Pr(&gt; t)    </span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu1     0.014249   0.003779   3.771 0.000163 ***</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu3     0.038145   0.005432   7.022 2.19e-12 ***</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha11 0.164235   0.034455   4.767 1.87e-06 ***</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha12 0.256936   0.037036   6.937 3.99e-12 ***</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha33 0.259345   0.048438   5.354 8.60e-08 ***</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha34 0.475611   0.061466   7.738 1.01e-14 ***</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta1.1 0.589374   0.059217   9.953  &lt; 2e-16 ***</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta3.1 1.062674   0.102009  10.417  &lt; 2e-16 ***</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha1n 0.171924   0.045805   3.753 0.000174 ***</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha1w 0.100048   0.031493   3.177 0.001489 ** </span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha2n 0.109703   0.057208   1.918 0.055160 .  </span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha2w 0.160902   0.050062   3.214 0.001309 ** </span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
</div>
<div id="bid-ask-price-model" class="section level3">
<h3>Bid-ask price model</h3>
<p>In this model, we use a system of counting processes with the
corresponding conditional intensities to describe the bid-ask price
processes:</p>
<p><span class="math display">\[ N_t = \begin{bmatrix}
N_1(t) \\ N_2(t) \\ N_3(t) \\ N_4(t)
\end{bmatrix},
\quad
\lambda_t =
\begin{bmatrix} \lambda_1(t) \\ \lambda_2(t) \\ \lambda_3(t) \\
\lambda_4(t)
\end{bmatrix}
\]</span></p>
<p>The ask price process <span class="math inline">\(N_1(t) -
N_2(t)\)</span> and the bid price process is <span class="math inline">\(N_3(t) - N_4(t)\)</span>. The mid price process is
<span class="math inline">\(p(t) = N_1(t) + N_3(t) - N_2(t) -
N_4(t)\)</span> plus initial mid price level.</p>
<p>The base intensity process is</p>
<p><span class="math display">\[\mu = \begin{bmatrix} \mu_1 \\ \zeta
\ell(t-) \\ \zeta \ell(t-) \\ \mu_1 \end{bmatrix}, \quad \ell(t) =
\frac{L(t)}{p(t)} \]</span></p>
<p>where <span class="math inline">\(L(t) \in \{ 0, 1, 2, \cdots
\}\)</span> is the absolute level of the bid-ask spread with <span class="math inline">\(L(t)=0\)</span> implying the minimum level. Note
that in the following code of the definition of <code>mu</code>,
<code>n</code> is needed to represent time <span class="math inline">\(t\)</span> and <code>Nc</code> is needed to
calculate the level and mid price.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># presumed initial bid and ask prices</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>initial_ask_price <span class="ot">&lt;-</span> <span class="dv">1250</span> <span class="co">#cents</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>initial_bid_price <span class="ot">&lt;-</span> <span class="dv">1150</span> <span class="co">#cents</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>initial_level <span class="ot">&lt;-</span> <span class="fu">round</span>((initial_ask_price <span class="sc">-</span> initial_bid_price) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>initial_mid_price <span class="ot">&lt;-</span> (initial_bid_price <span class="sc">+</span> initial_ask_price) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">param =</span> <span class="fu">c</span>(<span class="at">mu1 =</span> <span class="fl">0.08</span>, <span class="at">zeta1 =</span> <span class="fl">0.10</span>), <span class="at">n=</span>n, <span class="at">Nc=</span>Nc, ...){</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(n <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>    level <span class="ot">&lt;-</span> initial_level</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>    mid <span class="ot">&lt;-</span> initial_mid_price</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>    level <span class="ot">&lt;-</span> Nc[n<span class="dv">-1</span>,<span class="dv">1</span>] <span class="sc">-</span> Nc[n<span class="dv">-1</span>,<span class="dv">2</span>] <span class="sc">-</span> (Nc[n<span class="dv">-1</span>,<span class="dv">3</span>] <span class="sc">-</span> Nc[n<span class="dv">-1</span>,<span class="dv">4</span>]) <span class="sc">+</span> initial_level</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>    ask <span class="ot">&lt;-</span> initial_ask_price <span class="sc">+</span> (Nc[n<span class="dv">-1</span>,<span class="dv">1</span>] <span class="sc">-</span> Nc[n<span class="dv">-1</span>,<span class="dv">2</span>]) </span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>    bid <span class="ot">&lt;-</span> initial_bid_price <span class="sc">+</span> (Nc[n<span class="dv">-1</span>,<span class="dv">3</span>] <span class="sc">-</span> Nc[n<span class="dv">-1</span>,<span class="dv">4</span>]) </span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>    mid <span class="ot">&lt;-</span> (ask <span class="sc">+</span> bid) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(level <span class="sc">&lt;=</span> <span class="dv">0</span>){</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">matrix</span>(<span class="fu">c</span>(param[<span class="st">&quot;mu1&quot;</span>], <span class="dv">0</span>,</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>             <span class="dv">0</span>, param[<span class="st">&quot;mu1&quot;</span>]), <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">matrix</span>(<span class="fu">c</span>(param[<span class="st">&quot;mu1&quot;</span>], param[<span class="st">&quot;zeta1&quot;</span>] <span class="sc">*</span> level <span class="sc">/</span> mid,</span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>             param[<span class="st">&quot;zeta1&quot;</span>]<span class="sc">*</span>level <span class="sc">/</span> mid, param[<span class="st">&quot;mu1&quot;</span>]), <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>In addition, the kernel is represented by</p>
<p><span class="math display">\[h(t, u) =
\begin{bmatrix} \alpha_{s1} &amp; \alpha_{m} &amp; \alpha_{s2} &amp; 0
\\   \alpha_{w1} &amp; \alpha_{n1}(u) &amp; \alpha_{n1}(u) &amp;
\alpha_{w2} \\  \alpha_{w2} &amp; \alpha_{n2}(u) &amp; \alpha_{n2}(u)
&amp; \alpha_{w1} \\  0 &amp; \alpha_{s2} &amp; \alpha_{m} &amp;
\alpha_{s1} \\   \end{bmatrix},
\]</span></p>
<p>where</p>
<p><span class="math display">\[
\alpha_{n1}(u) = - \sum_{j=1}^4 \lambda_{2j}(u) + \xi \ell(u), \quad
\alpha_{n2}(u) = - \sum_{j=1}^4 \lambda_{3j}(u) + \xi \ell(u),
\]</span></p>
<p>for constant <span class="math inline">\(\xi \geq 0\)</span> and
<span class="math inline">\(\lambda_{ij}\)</span> is a component of
<span class="math inline">\(\lambda_i\)</span> such that</p>
<p><span class="math display">\[\lambda_{ij}(t) = \int_{-\infty}^t
h_{ij}(t, u) d N_j(u).\]</span></p>
<p>In the following code, we separate the constant part of <span class="math inline">\(h\)</span> as <code>alpha</code> and stochastic
part as <code>impact</code>. To represent <span class="math inline">\(\lambda_{ij}\)</span>, we need
<code>lambda_component_n</code>. Note that</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">param =</span> <span class="fu">c</span>(<span class="at">alpha_s1=</span><span class="dv">4</span>, <span class="at">alpha_m=</span><span class="dv">26</span>, <span class="at">alpha_s2=</span><span class="dv">5</span>,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">alpha_w1=</span><span class="dv">11</span>, <span class="at">alpha_w2=</span><span class="dv">7</span>)){</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="fu">c</span>(param[<span class="st">&quot;alpha_s1&quot;</span>], param[<span class="st">&quot;alpha_m&quot;</span>], param[<span class="st">&quot;alpha_s2&quot;</span>], <span class="dv">0</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>           param[<span class="st">&quot;alpha_w1&quot;</span>], <span class="dv">0</span>, <span class="dv">0</span>, param[<span class="st">&quot;alpha_w2&quot;</span>],</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>           param[<span class="st">&quot;alpha_w2&quot;</span>], <span class="dv">0</span>, <span class="dv">0</span>, param[<span class="st">&quot;alpha_w1&quot;</span>],</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>           <span class="dv">0</span>, param[<span class="st">&quot;alpha_s2&quot;</span>], param[<span class="st">&quot;alpha_m&quot;</span>], param[<span class="st">&quot;alpha_s1&quot;</span>]), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>impact <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">param =</span> <span class="fu">c</span>(<span class="at">xi =</span> <span class="fl">2.7</span>), <span class="at">n=</span>n, <span class="at">Nc=</span>Nc, <span class="at">lambda_component =</span> lambda_component, ... ){</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(n <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>    level <span class="ot">&lt;-</span>  initial_level</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>    mid <span class="ot">&lt;-</span> initial_mid_price</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    level <span class="ot">&lt;-</span> Nc[n,<span class="dv">1</span>] <span class="sc">-</span> Nc[n,<span class="dv">2</span>] <span class="sc">-</span> (Nc[n,<span class="dv">3</span>] <span class="sc">-</span> Nc[n,<span class="dv">4</span>]) <span class="sc">+</span> initial_level</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    ask <span class="ot">&lt;-</span> initial_ask_price <span class="sc">+</span> (Nc[n,<span class="dv">1</span>] <span class="sc">-</span> Nc[n,<span class="dv">2</span>])</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    bid <span class="ot">&lt;-</span> initial_bid_price <span class="sc">+</span> (Nc[n,<span class="dv">3</span>] <span class="sc">-</span> Nc[n,<span class="dv">4</span>])</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>    mid <span class="ot">&lt;-</span> (ask <span class="sc">+</span> bid)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  lambda_component_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(lambda_component[n, ], <span class="at">nrow=</span><span class="dv">4</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  l2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(lambda_component_matrix[<span class="dv">2</span>,]) <span class="co"># sum of second row</span></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>  l3 <span class="ot">&lt;-</span> <span class="fu">sum</span>(lambda_component_matrix[<span class="dv">3</span>,]) <span class="co"># sum of third row</span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>  im <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">0</span>, <span class="sc">-</span>l2 <span class="sc">+</span> param[<span class="st">&quot;xi&quot;</span>]<span class="sc">*</span>level<span class="sc">/</span>mid, <span class="sc">-</span>l2 <span class="sc">+</span> param[<span class="st">&quot;xi&quot;</span>]<span class="sc">*</span>level<span class="sc">/</span>mid, <span class="dv">0</span>,</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">0</span>, <span class="sc">-</span>l3 <span class="sc">+</span> param[<span class="st">&quot;xi&quot;</span>]<span class="sc">*</span>level<span class="sc">/</span>mid, <span class="sc">-</span>l3 <span class="sc">+</span> param[<span class="st">&quot;xi&quot;</span>]<span class="sc">*</span>level<span class="sc">/</span>mid, <span class="dv">0</span>,</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">50</span>, <span class="dv">16</span>), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>rmark <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n=</span>n, <span class="at">Nc=</span>Nc, type, ...){</span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(n <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>    level <span class="ot">&lt;-</span>  initial_level</span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a>    level <span class="ot">&lt;-</span> Nc[n<span class="dv">-1</span>,<span class="dv">1</span>] <span class="sc">-</span> Nc[n<span class="dv">-1</span>,<span class="dv">2</span>] <span class="sc">-</span> (Nc[n<span class="dv">-1</span>,<span class="dv">3</span>] <span class="sc">-</span> Nc[n<span class="dv">-1</span>,<span class="dv">4</span>]) <span class="sc">+</span> initial_level</span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (type[n] <span class="sc">==</span> <span class="dv">2</span> <span class="sc">|</span> type[n] <span class="sc">==</span> <span class="dv">3</span>){</span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">min</span>(level,  <span class="fu">rgeom</span>(<span class="dv">1</span>, <span class="at">p=</span><span class="fl">0.65</span>) <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rgeom</span>(<span class="dv">1</span>, <span class="at">p=</span><span class="fl">0.65</span>) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a>h_ba <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">&quot;hspec&quot;</span>, <span class="at">mu =</span> mu, <span class="at">alpha =</span> alpha, <span class="at">beta =</span> beta, <span class="at">impact=</span>impact, <span class="at">rmark =</span> rmark)</span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a>h_ba</span>
<span id="cb50-51"><a href="#cb50-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; An object of class &quot;hsepc&quot; of 4-dimensional Hawkes process</span></span>
<span id="cb50-52"><a href="#cb50-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb50-53"><a href="#cb50-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot mu: </span></span>
<span id="cb50-54"><a href="#cb50-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; function(param = c(mu1 = 0.08, zeta1 = 0.10), n=n, Nc=Nc, ...){</span></span>
<span id="cb50-55"><a href="#cb50-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb50-56"><a href="#cb50-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   if(n == 1){</span></span>
<span id="cb50-57"><a href="#cb50-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     </span></span>
<span id="cb50-58"><a href="#cb50-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     level &lt;- initial_level</span></span>
<span id="cb50-59"><a href="#cb50-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     mid &lt;- initial_mid_price</span></span>
<span id="cb50-60"><a href="#cb50-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     </span></span>
<span id="cb50-61"><a href="#cb50-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   } else {</span></span>
<span id="cb50-62"><a href="#cb50-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     </span></span>
<span id="cb50-63"><a href="#cb50-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     level &lt;- Nc[n-1,1] - Nc[n-1,2] - (Nc[n-1,3] - Nc[n-1,4]) + initial_level</span></span>
<span id="cb50-64"><a href="#cb50-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     ask &lt;- initial_ask_price + (Nc[n-1,1] - Nc[n-1,2]) </span></span>
<span id="cb50-65"><a href="#cb50-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     bid &lt;- initial_bid_price + (Nc[n-1,3] - Nc[n-1,4]) </span></span>
<span id="cb50-66"><a href="#cb50-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     mid &lt;- (ask + bid) / 2</span></span>
<span id="cb50-67"><a href="#cb50-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     </span></span>
<span id="cb50-68"><a href="#cb50-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   }</span></span>
<span id="cb50-69"><a href="#cb50-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb50-70"><a href="#cb50-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   if(level &lt;= 0){</span></span>
<span id="cb50-71"><a href="#cb50-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     matrix(c(param[&quot;mu1&quot;], 0,</span></span>
<span id="cb50-72"><a href="#cb50-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              0, param[&quot;mu1&quot;]), nrow = 4)</span></span>
<span id="cb50-73"><a href="#cb50-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   } else {</span></span>
<span id="cb50-74"><a href="#cb50-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     matrix(c(param[&quot;mu1&quot;], param[&quot;zeta1&quot;] * level / mid,</span></span>
<span id="cb50-75"><a href="#cb50-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              param[&quot;zeta1&quot;]*level / mid, param[&quot;mu1&quot;]), nrow = 4)</span></span>
<span id="cb50-76"><a href="#cb50-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb50-77"><a href="#cb50-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   }</span></span>
<span id="cb50-78"><a href="#cb50-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb50-79"><a href="#cb50-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb50-80"><a href="#cb50-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000027a9183c268&gt;</span></span>
<span id="cb50-81"><a href="#cb50-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb50-82"><a href="#cb50-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot alpha: </span></span>
<span id="cb50-83"><a href="#cb50-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; function(param = c(alpha_s1=4, alpha_m=26, alpha_s2=5,</span></span>
<span id="cb50-84"><a href="#cb50-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                             alpha_w1=11, alpha_w2=7)){</span></span>
<span id="cb50-85"><a href="#cb50-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   matrix(c(param[&quot;alpha_s1&quot;], param[&quot;alpha_m&quot;], param[&quot;alpha_s2&quot;], 0,</span></span>
<span id="cb50-86"><a href="#cb50-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            param[&quot;alpha_w1&quot;], 0, 0, param[&quot;alpha_w2&quot;],</span></span>
<span id="cb50-87"><a href="#cb50-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            param[&quot;alpha_w2&quot;], 0, 0, param[&quot;alpha_w1&quot;],</span></span>
<span id="cb50-88"><a href="#cb50-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            0, param[&quot;alpha_s2&quot;], param[&quot;alpha_m&quot;], param[&quot;alpha_s1&quot;]), nrow = 4, byrow = TRUE)</span></span>
<span id="cb50-89"><a href="#cb50-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb50-90"><a href="#cb50-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000027a9183c268&gt;</span></span>
<span id="cb50-91"><a href="#cb50-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb50-92"><a href="#cb50-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot beta: </span></span>
<span id="cb50-93"><a href="#cb50-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb50-94"><a href="#cb50-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]   50   50   50   50</span></span>
<span id="cb50-95"><a href="#cb50-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,]   50   50   50   50</span></span>
<span id="cb50-96"><a href="#cb50-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,]   50   50   50   50</span></span>
<span id="cb50-97"><a href="#cb50-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,]   50   50   50   50</span></span>
<span id="cb50-98"><a href="#cb50-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb50-99"><a href="#cb50-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot impact: </span></span>
<span id="cb50-100"><a href="#cb50-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; function(param = c(xi = 2.7), n=n, Nc=Nc, lambda_component = lambda_component, ... ){</span></span>
<span id="cb50-101"><a href="#cb50-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   if(n == 1){</span></span>
<span id="cb50-102"><a href="#cb50-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     level &lt;-  initial_level</span></span>
<span id="cb50-103"><a href="#cb50-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     mid &lt;- initial_mid_price</span></span>
<span id="cb50-104"><a href="#cb50-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   } else {</span></span>
<span id="cb50-105"><a href="#cb50-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     level &lt;- Nc[n,1] - Nc[n,2] - (Nc[n,3] - Nc[n,4]) + initial_level</span></span>
<span id="cb50-106"><a href="#cb50-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     ask &lt;- initial_ask_price + (Nc[n,1] - Nc[n,2])</span></span>
<span id="cb50-107"><a href="#cb50-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     bid &lt;- initial_bid_price + (Nc[n,3] - Nc[n,4])</span></span>
<span id="cb50-108"><a href="#cb50-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     mid &lt;- (ask + bid)/2</span></span>
<span id="cb50-109"><a href="#cb50-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   }</span></span>
<span id="cb50-110"><a href="#cb50-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb50-111"><a href="#cb50-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   lambda_component_matrix &lt;- matrix(lambda_component[n, ], nrow=4, byrow=TRUE)</span></span>
<span id="cb50-112"><a href="#cb50-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb50-113"><a href="#cb50-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   l2 &lt;- sum(lambda_component_matrix[2,]) # sum of second row</span></span>
<span id="cb50-114"><a href="#cb50-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   l3 &lt;- sum(lambda_component_matrix[3,]) # sum of third row</span></span>
<span id="cb50-115"><a href="#cb50-115" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb50-116"><a href="#cb50-116" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   im &lt;- matrix(c(0, 0, 0, 0,</span></span>
<span id="cb50-117"><a href="#cb50-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  0, -l2 + param[&quot;xi&quot;]*level/mid, -l2 + param[&quot;xi&quot;]*level/mid, 0,</span></span>
<span id="cb50-118"><a href="#cb50-118" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  0, -l3 + param[&quot;xi&quot;]*level/mid, -l3 + param[&quot;xi&quot;]*level/mid, 0,</span></span>
<span id="cb50-119"><a href="#cb50-119" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  0, 0, 0, 0), nrow = 4, byrow = TRUE)</span></span>
<span id="cb50-120"><a href="#cb50-120" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb50-121"><a href="#cb50-121" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb50-122"><a href="#cb50-122" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000027a9183c268&gt;</span></span>
<span id="cb50-123"><a href="#cb50-123" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb50-124"><a href="#cb50-124" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Slot rmark: </span></span>
<span id="cb50-125"><a href="#cb50-125" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; function(n=n, Nc=Nc, type, ...){</span></span>
<span id="cb50-126"><a href="#cb50-126" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   if(n == 1){</span></span>
<span id="cb50-127"><a href="#cb50-127" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     level &lt;-  initial_level</span></span>
<span id="cb50-128"><a href="#cb50-128" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   } else {</span></span>
<span id="cb50-129"><a href="#cb50-129" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     level &lt;- Nc[n-1,1] - Nc[n-1,2] - (Nc[n-1,3] - Nc[n-1,4]) + initial_level</span></span>
<span id="cb50-130"><a href="#cb50-130" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   }</span></span>
<span id="cb50-131"><a href="#cb50-131" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   if (type[n] == 2 | type[n] == 3){</span></span>
<span id="cb50-132"><a href="#cb50-132" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     min(level,  rgeom(1, p=0.65) + 1)</span></span>
<span id="cb50-133"><a href="#cb50-133" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   } else {</span></span>
<span id="cb50-134"><a href="#cb50-134" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     rgeom(1, p=0.65) + 1</span></span>
<span id="cb50-135"><a href="#cb50-135" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   }</span></span>
<span id="cb50-136"><a href="#cb50-136" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb50-137"><a href="#cb50-137" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000027a9183c268&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>hr_ba <span class="ot">&lt;-</span> <span class="fu">hsim</span>(h_ba, <span class="at">size=</span><span class="dv">1000</span>, <span class="at">lambda_component0 =</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">16</span>), <span class="dv">4</span>))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hr_ba)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simulation result of marked Hawkes model.</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Realized path :</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         arrival N1 N2 N3 N4 mark lambda1   lambda2   lambda3   lambda4</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,]  0.000000  0  0  0  0    0 4.08000 4.0082500 4.0082500  4.080000</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,]  0.071944  0  0  1  0    1 0.18960 0.1178535 0.1178535  0.189604</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,]  0.083521  1  0  1  0    2 2.94409 0.1317088 0.1317088 14.715239</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,]  0.105149  1  1  1  0    1 2.40776 3.7805504 2.4240665  5.043116</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,]  7.936156  2  1  1  0    5 0.08000 0.0082431 0.0082431  0.080000</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,]  7.948085  2  1  2  0    1 2.28302 6.0669434 3.8639245  0.080000</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,]  7.953389  2  1  2  1    1 5.60512 0.1857295 0.1857295 20.023463</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,]  7.968243  2  1  2  2    1 2.70901 3.4237505 5.3270672 11.472998</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 14.539107  2  1  2  3    3 0.08000 0.0087282 0.0087282  0.080000</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 18.537488  3  1  2  3    3 0.08000 0.0089888 0.0089888  0.080000</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 18.599612  3  1  3  3    1 0.25908 0.5016981 0.3226176  0.080000</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [12,] 28.348531  3  1  3  4    1 0.08000 0.0091400 0.0091400  0.080000</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [13,] 28.697134  3  1  3  5    1 0.08000 0.0092271 0.0092272  0.080000</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [14,] 38.176858  3  1  3  6    1 0.08000 0.0093139 0.0093139  0.080000</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [15,] 38.460698  4  1  3  6    4 0.08000 0.0094058 0.0094085  0.080003</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [16,] 65.653042  5  1  3  6    3 0.08000 0.0097176 0.0097176  0.080000</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [17,] 65.671917  6  1  3  6    1 1.63666 4.2907779 2.7341148  0.080000</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [18,] 65.686104  6  2  3  6    2 2.81376 7.5278716 4.7941121  0.080000</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [19,] 75.299572  7  2  3  6    3 0.08000 0.0098755 0.0098755  0.080000</span></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [20,] 75.329555  8  2  3  6    1 0.97328 2.4666315 1.5733516  0.080000</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... with 980 more rows </span></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span></code></pre></div>
<p>As a separate log-likelihood estimation performed, the parameter for
mark distribution is not estimated.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>mle_ba <span class="ot">&lt;-</span> <span class="fu">hfit</span>(h_ba, <span class="at">inter_arrival =</span> hr_ba<span class="sc">$</span>inter_arrival, <span class="at">type =</span> hr_ba<span class="sc">$</span>type,</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">lambda_component0 =</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">16</span>), <span class="dv">4</span>))</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mle_ba)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BFGS maximization, 35 iterations</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Return code 0: successful convergence </span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -1636.853 </span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9  free parameters</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimates:</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Estimate Std. error t value  Pr(&gt; t)    </span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu1       0.080464   0.004102  19.618  &lt; 2e-16 ***</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; zeta1     0.144347   0.011955  12.074  &lt; 2e-16 ***</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha_s1  4.009503        NaN     NaN      NaN    </span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha_m  26.413030   0.319883  82.571  &lt; 2e-16 ***</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha_s2  3.530883   0.378310   9.333  &lt; 2e-16 ***</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha_w1 11.647698        NaN     NaN      NaN    </span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alpha_w2  7.509122   0.954276   7.869 3.58e-15 ***</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta1.1  51.534095        NaN     NaN      NaN    </span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; xi        4.057684        NaN     NaN      NaN    </span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
